(function(e){function t(t){for(var r,o,s=t[0],c=t[1],l=t[2],d=0,h=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&h.push(i[o][0]),i[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(h.length)h.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},i={app:0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),i={id:"app"};function a(e,t,n,a,o,s){var c=Object(r["i"])("Map"),l=Object(r["i"])("Header"),u=Object(r["i"])("InfoBox");return Object(r["g"])(),Object(r["c"])("div",i,[Object(r["e"])(c,{ref:"map"},null,512),Object(r["e"])(l,{ref:"header"},null,512),Object(r["e"])(u,{ref:"infoBox"},null,512)])}var o={class:"header"},s=Object(r["d"])("img",{src:"/img/layout/eut-logo.svg",class:"eut-logo"},null,-1),c={class:"btn-group btn-group-lg",role:"group"},l=Object(r["d"])("img",{src:"/img/layout/saja-logo.svg",class:"saja-logo"},null,-1);function u(e,t,n,i,a,u){return Object(r["g"])(),Object(r["c"])("div",o,[s,Object(r["d"])("div",c,[Object(r["d"])("button",{type:"button",class:Object(r["f"])(["btn","de"==a.currentLanguage?"btn-secondary":"btn-primary"]),onClick:t[0]||(t[0]=function(e){return u.setLanguage("de")})},"DE",2),Object(r["d"])("button",{type:"button",class:Object(r["f"])(["btn","en"==a.currentLanguage?"btn-secondary":"btn-primary"]),onClick:t[1]||(t[1]=function(e){return u.setLanguage("en")})},"EN",2)]),l])}n("d81d");var d={data:function(){return{currentLanguage:"de"}},methods:{setLanguage:function(e){this.currentLanguage=e,console.log(this.$root.$refs["map"].setLanguage(e))}}},h=n("6b0d"),p=n.n(h);const f=p()(d,[["render",u]]);var g=f,m={class:"map-container"},b={ref:"map",class:"map"},v=Object(r["d"])("div",{class:"credits small"},"Â©swisstopo",-1),y=Object(r["d"])("div",{id:"location-marker"},null,-1);function w(e,t,n,i,a,o){return Object(r["g"])(),Object(r["c"])("div",m,[Object(r["d"])("div",b,null,512),v,y])}n("ac1f"),n("1276"),n("d3b7"),n("25f0"),n("a9e3");var O=n("bc3a"),j=n.n(O),I=(n("5bc0"),n("5eee")),S=n("f5dd"),M=n("480c"),x=n("3e6b"),F=n("f2f0"),P=n("a2c7"),k=n("256f"),L=n("6c77"),E=n("83a6"),A=n("6cbf"),R=n("ce2c"),T=n("8682"),C=n("8295"),Z=n("5831"),B=n("55bd"),G=n("a2e1"),$=new S["a"]({code:"EPSG:21781",extent:[485869.5728,76443.1884,837076.5648,299941.7864],units:"m"});Object(k["c"])($);var H={},_={primary:"#968C1B",primaryOpacity:"rgba(150,140,27,0.7)"},z=new Z["a"],N=new Z["a"],Y=new Z["a"],D=new Z["a"],J=new B["a"]({distance:24,minDistance:10,source:D}),U={props:{},data:function(){return{map:!1,active:"topo",zoom:4.5,q:null,showResults:!1,results:null,inputName:null,selected:null,language:"de",initialItem:{type:null,id:null},initialItemSelected:!1,layers:{topo:null,ortho:null,hiking:null,transport:null,poi:null,route:null,perimeter:null},defaultOpacity:{topo:1,ortho:1,hiking:.5,transport:1,poi:1,route:1,perimeter:.3}}},methods:{setLanguage:function(e){this.language=e},hideLayer:function(e){this.layers[e].setOpacity(0),"route"==e&&this.layers["generalRoute"].setOpacity(0)},showLayer:function(e){this.layers[e].setOpacity(this.defaultOpacity[e]),"route"==e&&this.layers["generalRoute"].setOpacity(this.defaultOpacity[e])},selectFeature:function(e){var t=this,n=this.map,r=n.getView();n.forEachFeatureAtPixel(e.pixel,(function(e){t.deselectFeature();var n=e.getProperties();if(n.features){var i=n.features;if(i.length>1){var a=e.getGeometry().getCoordinates(),o=r.getZoom();r.setCenter(a),r.setZoom(o+1)}else{var s=i[0],c=s.getProperties();t.selected=s,t.fetchFeatureInfo(c),s.set("highlighted",!0)}}else t.selected=e,t.fetchFeatureInfo(n),"route"==n.type&&e.set("highlighted",!0);return!0}),{hitTolerance:6})},deselectFeature:function(){null!==this.selected&&(this.selected.set("highlighted",!1),this.selected=null,this.$parent.$refs.infoBox.close())},onPointerMove:function(e){var t=this.map.getEventPixel(e.originalEvent),n=this.map.hasFeatureAtPixel(t,{layerFilter:function(e){return"perimeter-layer"!==e.get("id")}});this.map.getTarget().style.cursor=n?"pointer":""},onMoveend:function(){var e=this.map.getView(),t=this.map.getSize(),n=e.calculateExtent(t);this.fetchPerimeters(n,t[0],t[1]);var r=e.getZoom();this.zoom!=r&&(this.zoom=r)},fetchPerimeters:function(e,t,n){var r="https://sdi.cde.unibe.ch/geoserver/ourheritage/wms?service=WMS&version=1.1.0&request=GetMap&layers=ourheritage%3Awelterbe_perimeter&srs=EPSG%3A21781&styles=&format=geojson";r+="&bbox="+e,r+="&width="+t,r+="&height="+n,j.a.get(r).then((function(e){z.clear(),z.addFeatures((new G["a"]).readFeatures(e.data))}))},fetchPois:function(){var e=this;j.a.get("poi/list?frontend="+this.getFrontend()).then((function(t){D.addFeatures((new G["a"]).readFeatures(t.data)),e.selectInitialItem("poi",D)}))},fetchRoutes:function(){var e=this;j.a.get("route/list?type=detail&frontend="+this.getFrontend()).then((function(t){Y.addFeatures((new G["a"]).readFeatures(t.data)),e.selectInitialItem("route",Y)})),j.a.get("route/list?type=general&frontend="+this.getFrontend()).then((function(t){N.addFeatures((new G["a"]).readFeatures(t.data)),e.selectInitialItem("route",N)}))},getFrontend:function(){var e=document.getElementById("heritage-map");return e.getAttribute("frontend")},fetchFeatureInfo:function(e){var t=this,n=e.type+"/"+e.id+"?fullDescription=1&lang="+this.language;j.a.get(n).then((function(e){t.$parent.$refs.infoBox.setInfo(e.data)}))},selectInitialItem:function(e,t){if(!this.initialItemSelected&&this.initialItem.type==e)for(var n=this.map.getView(),r=t.getFeatures(),i=0,a=r.length;i<a;i++){var o=r[i],s=o.getProperties();if(s.id==this.initialItem.id){this.initialItemSelected=!0,this.selected=o,this.fetchFeatureInfo(s),"heritage"==e?this.selectedHeritage(o):(n.fit(o.getGeometry(),{padding:[60,60,60,60]}),"route"==s.type&&o.set("highlighted",!0),"poi"==s.type&&o.set("highlighted",!0));break}}},setInitalItem:function(){var e=document.getElementById("heritage-map"),t=e.getAttribute("show");if(t&&""!=t){var n=t.split("-");this.initialItem.type=n[0],this.initialItem.id=n[1]}}},mounted:function(){this.map=new I["a"]({target:this.$refs["map"],layers:[this.layers.ortho=new M["a"]({id:"ortho-layer",opacity:0,source:new F["a"]({url:"https://wms.geo.admin.ch/",params:{LAYERS:"ch.swisstopo.swissimage",FORMAT:"image/jpeg"},serverType:"mapserver"})}),this.layers.topo=new M["a"]({id:"topo-layer",opacity:1,source:new F["a"]({url:"https://wms.geo.admin.ch/",params:{LAYERS:"ch.swisstopo.pixelkarte-grau",FORMAT:"image/jpeg"},serverType:"mapserver"})}),this.layers.perimeter=new x["a"]({id:"perimeter-layer",minZoom:3,opacity:this.defaultOpacity.perimeter,source:z,style:function(){return new L["b"]({fill:new E["a"]({color:_.primaryOpacity})})}}),this.layers.hiking=new M["a"]({id:"hiking-layer",opacity:0,minZoom:5,source:new F["a"]({url:"https://wms.geo.admin.ch/",params:{LAYERS:"ch.swisstopo.swisstlm3d-wanderwege"}})}),this.layers.route=new x["a"]({id:"route-layer",minZoom:3,source:Y,style:function(e){return V(e)}}),this.layers.generalRoute=new x["a"]({id:"general-route-layer",source:N,style:function(e){return V(e)}}),this.layers.transport=new M["a"]({id:"transport-layer",opacity:0,minZoom:8,source:new F["a"]({url:"https://wms.geo.admin.ch/",params:{LAYERS:"ch.bav.haltestellen-oev"}})}),this.layers.poi=new x["a"]({id:"poi-layer",minZoom:3,source:J,style:function(e){var t=e.get("features");if(t[0].get("highlighted")){var n=H["poiSelected"],r=t[0].getProperties();return n||(n=new L["b"]({image:new A["a"]({anchor:[20,58],anchorXUnits:"pixels",anchorYUnits:"pixels",src:r.marker})}),H["poiSelected"]=n),n}var i=t.length,a=H[i];if(!a){var o=i+18;i>18&&(o=.2*i+11),a=new L["b"]({image:new R["a"]({radius:o,stroke:new T["a"]({color:"#fff",width:2}),fill:new E["a"]({color:_.primary})}),text:new C["a"]({text:i.toString(),font:o+"px sans-serif",fill:new E["a"]({color:"#fff"})})}),H[i]=a}return a}})],view:new P["a"]({projection:$,center:Object(k["r"])([8,46.53],"EPSG:4326","EPSG:21781"),zoom:this.zoom,minZoom:4.5,maxZoom:12,enableRotation:!1})}),this.map.on("pointermove",this.onPointerMove),this.map.on("click",this.selectFeature),this.map.on("moveend",this.onMoveend),this.setInitalItem(),this.fetchPois(),this.fetchRoutes()}};function V(e){return console.log(e),e.get("highlighted")?new L["b"]({stroke:new T["a"]({color:_.primaryOpacity,width:11})}):new L["b"]({stroke:new T["a"]({color:_.primaryOpacity,width:8})})}function q(e,t){e=Q(e),t=Q(t),e=ee(e),t=ee(t);var n=(e-169028.66)/1e4,r=(t-26782.5)/1e4,i=600072.37+211455.93*r-10938.51*r*n-.36*r*Math.pow(n,2)-44.54*Math.pow(r,3);return i}function W(e,t){e=Q(e),t=Q(t),e=ee(e),t=ee(t);var n=(e-169028.66)/1e4,r=(t-26782.5)/1e4,i=200147.07+308807.95*n+3745.25*Math.pow(r,2)+76.63*Math.pow(n,2)-194.56*Math.pow(r,2)*n+119.79*Math.pow(n,3);return i}function X(e,t){var n=(e-6e5)/1e6,r=(t-2e5)/1e6,i=16.9023892+3.238272*r-.270978*Math.pow(n,2)-.002528*Math.pow(r,2)-.0447*Math.pow(n,2)*r-.014*Math.pow(r,3);return i=100*i/36,i}function K(e,t){var n=(e-6e5)/1e6,r=(t-2e5)/1e6,i=2.6779094+4.728982*n+.791484*n*r+.1306*n*Math.pow(r,2)-.0436*Math.pow(n,3);return i=100*i/36,i}function Q(e){var t=parseInt(e,10),n=parseInt(60*(e-t),10),r=60*(60*(e-t)-n);return t+n/100+r/1e4}function ee(e){var t=parseInt(e,10),n=parseInt(100*(e-t),10),r=100*(100*(e-t)-n),i=String(e).split(".");return 2==i.length&&2==i[1].length&&(n=Number(i[1]),r=0),r+60*n+3600*t}Object(k["b"])("EPSG:4326",$,(function(e){return[q(e[1],e[0]),W(e[1],e[0])]}),(function(e){return[K(e[0],e[1]),X(e[0],e[1])]}));const te=p()(U,[["render",w]]);var ne=te,re=(n("a4d3"),n("e01a"),{class:"card fade-in"}),ie=["title"],ae=Object(r["d"])("i",{class:"fa fa-times"},null,-1),oe=[ae],se={class:"row"},ce={class:"col-lg-5 header-container"},le={class:"card-header img-header"},ue={class:"col-lg-7"},de={class:"card-body small"},he=["innerHTML"],pe=["innerHTML"];function fe(e,t,n,i,a,o){var s=Object(r["i"])("Slider");return Object(r["g"])(),Object(r["c"])("div",{id:"map-info-box",class:Object(r["f"])({active:a.active})},[Object(r["d"])("div",{class:"backdrop",onClick:t[0]||(t[0]=function(){return o.close&&o.close.apply(o,arguments)})}),Object(r["d"])("div",re,[Object(r["d"])("div",{class:"close",onClick:t[1]||(t[1]=function(){return o.close&&o.close.apply(o,arguments)}),title:this.translations.close},oe,8,ie),Object(r["d"])("div",se,[Object(r["d"])("div",ce,[Object(r["d"])("div",le,[Object(r["e"])(s,{ref:"slider",images:a.info.images},null,8,["images"])])]),Object(r["d"])("div",ue,[Object(r["d"])("div",de,[Object(r["d"])("div",{class:"h1 card-title margin-bottom",innerHTML:this.info.title},null,8,he),Object(r["d"])("div",{class:"card-text",innerHTML:this.info.description},null,8,pe)])])])])],2)}var ge={class:"slider"},me={class:"slides"},be=["src","alt"],ve=["onClick"];function ye(e,t,n,i,a,o){return Object(r["g"])(),Object(r["c"])("div",ge,[Object(r["d"])("ul",me,[(Object(r["g"])(!0),Object(r["c"])(r["a"],null,Object(r["h"])(n.images,(function(e,t){return Object(r["g"])(),Object(r["c"])("li",{key:e,class:Object(r["f"])([o.isActive(t),"fade-in"])},[Object(r["d"])("img",{src:e.url,alt:e.alt},null,8,be)],2)})),128))]),Object(r["d"])("ul",{class:Object(r["f"])(["pagination",o.showNav()])},[(Object(r["g"])(!0),Object(r["c"])(r["a"],null,Object(r["h"])(n.images,(function(e,t){return Object(r["g"])(),Object(r["c"])("li",{key:e,class:Object(r["f"])(o.isActive(t)),onClick:function(e){return o.setSlide(t)}},null,10,ve)})),128))],2)])}var we={props:{images:Array},data:function(){return{current:0}},methods:{isActive:function(e){return e==this.current?"active":""},setSlide:function(e){this.current=e},showNav:function(){return this.images.length<=1?"hide":""}},mounted:function(){}};const Oe=p()(we,[["render",ye]]);var je=Oe,Ie={components:{Slider:je},data:function(){return{active:!1,info:{id:null,type:null,slug:null,label:null,title:null,description:null,img:{url:null,alt:null},images:[]},currentSlide:0,translations:{close:"Close",learnMore:"Learn more"}}},methods:{setInfo:function(e){this.info=e,this.open()},open:function(){this.$refs["slider"].current=0,this.active=!0},close:function(){this.active=!1},setTranslations:function(){var e=document.getElementById("map-translations");e&&(this.translations=JSON.parse(e.textContent))},slideIsActive:function(e){return e==this.currentSlide?"active":""},setSlide:function(e){this.currentSlide=e}},mounted:function(){this.setTranslations()}};const Se=p()(Ie,[["render",fe]]);var Me=Se,xe={name:"map",components:{Header:g,Map:ne,InfoBox:Me}};const Fe=p()(xe,[["render",a]]);var Pe=Fe;n("9607");j.a.defaults.baseURL="https://api.ourheritage.ch/v1",Object(r["b"])(Pe).mount("#heritage-map")},9607:function(e,t,n){}});
//# sourceMappingURL=app.eff303f3.js.map